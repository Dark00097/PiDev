<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.CheckBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.PasswordField?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.shape.SVGPath?>

<VBox xmlns="http://javafx.com/javafx/17"
      xmlns:fx="http://javafx.com/fxml/1"
      fx:controller="com.nexora.bank.controllers.AdminSecuritySettingsController"
      stylesheets="@../css/User.css"
      styleClass="nx-entity-container nx-module-content"
      spacing="24">

    <HBox styleClass="nx-page-header" alignment="CENTER_LEFT">
        <VBox spacing="4">
            <Label text="Admin Account Management" styleClass="nx-page-title"/>
            <Label text="Manage your admin profile, password, and security policies" styleClass="nx-page-subtitle"/>
        </VBox>
    </HBox>

    <VBox styleClass="nx-card" spacing="0">
        <HBox styleClass="nx-card-header" alignment="CENTER_LEFT" spacing="12">
            <StackPane styleClass="nx-card-header-icon, nx-card-header-icon-purple">
                <SVGPath content="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2M12 7a4 4 0 1 0 0-8 4 4 0 0 0 0 8z"/>
            </StackPane>
            <VBox spacing="2">
                <Label text="My Admin Profile" styleClass="nx-card-title"/>
                <Label text="Update your identity and contact information" styleClass="nx-card-subtitle"/>
            </VBox>
        </HBox>

        <VBox styleClass="nx-card-body" spacing="14">
            <HBox spacing="12">
                <VBox styleClass="nx-form-group" spacing="8" HBox.hgrow="ALWAYS">
                    <Label text="Nom" styleClass="nx-label, nx-label-required"/>
                    <TextField fx:id="txtNom" promptText="Nom" styleClass="nx-input"/>
                </VBox>
                <VBox styleClass="nx-form-group" spacing="8" HBox.hgrow="ALWAYS">
                    <Label text="Prenom" styleClass="nx-label, nx-label-required"/>
                    <TextField fx:id="txtPrenom" promptText="Prenom" styleClass="nx-input"/>
                </VBox>
            </HBox>

            <HBox spacing="12">
                <VBox styleClass="nx-form-group" spacing="8" HBox.hgrow="ALWAYS">
                    <Label text="Email" styleClass="nx-label, nx-label-required"/>
                    <TextField fx:id="txtEmail" promptText="email@domain.com" styleClass="nx-input"/>
                </VBox>
                <VBox styleClass="nx-form-group" spacing="8" HBox.hgrow="ALWAYS">
                    <Label text="Telephone" styleClass="nx-label, nx-label-required"/>
                    <TextField fx:id="txtTelephone" promptText="+216 XX XXX XXX" styleClass="nx-input"/>
                </VBox>
            </HBox>

            <HBox spacing="12" alignment="CENTER_LEFT">
                <Label text="Role:" styleClass="nx-label"/>
                <Label fx:id="lblRole" text="ROLE_ADMIN" styleClass="nx-ban-target"/>
                <Label text="Status:" styleClass="nx-label"/>
                <Label fx:id="lblAccountStatus" text="ACTIVE" styleClass="nx-ban-target"/>
            </HBox>
        </VBox>

        <HBox styleClass="nx-card-footer" alignment="CENTER_RIGHT" spacing="12">
            <Button text="Save profile" styleClass="nx-btn, nx-btn-primary" onAction="#handleSaveProfile"/>
        </HBox>
    </VBox>

    <VBox styleClass="nx-card" spacing="0">
        <HBox styleClass="nx-card-header" alignment="CENTER_LEFT" spacing="12">
            <StackPane styleClass="nx-card-header-icon, nx-card-header-icon-teal">
                <SVGPath content="M12 1l8 4v6c0 4.6-3.4 8.9-8 10-4.6-1.1-8-5.4-8-10V5l8-4z"/>
            </StackPane>
            <VBox spacing="2">
                <Label text="Admin Password" styleClass="nx-card-title"/>
                <Label text="Biometric verification is required before password change" styleClass="nx-card-subtitle"/>
            </VBox>
        </HBox>

        <VBox styleClass="nx-card-body" spacing="14">
            <VBox styleClass="nx-form-group" spacing="8">
                <Label text="Current password" styleClass="nx-label, nx-label-required"/>
                <PasswordField fx:id="txtCurrentPassword" promptText="Current password" styleClass="nx-input"/>
            </VBox>

            <HBox spacing="12">
                <VBox styleClass="nx-form-group" spacing="8" HBox.hgrow="ALWAYS">
                    <Label text="New password" styleClass="nx-label, nx-label-required"/>
                    <PasswordField fx:id="txtNewPassword" promptText="Strong password" styleClass="nx-input"/>
                </VBox>
                <VBox styleClass="nx-form-group" spacing="8" HBox.hgrow="ALWAYS">
                    <Label text="Confirm new password" styleClass="nx-label, nx-label-required"/>
                    <PasswordField fx:id="txtConfirmNewPassword" promptText="Confirm new password" styleClass="nx-input"/>
                </VBox>
            </HBox>
        </VBox>

        <HBox styleClass="nx-card-footer" alignment="CENTER_RIGHT" spacing="12">
            <Button text="Change password (biometric)" styleClass="nx-btn, nx-btn-secondary" onAction="#handleChangePassword"/>
        </HBox>
    </VBox>

    <VBox styleClass="nx-card" spacing="0">
        <HBox styleClass="nx-card-header" alignment="CENTER_LEFT" spacing="12">
            <StackPane styleClass="nx-card-header-icon, nx-card-header-icon-purple">
                <SVGPath content="M12 1l9 4v6c0 5-3.8 9.7-9 11-5.2-1.3-9-6-9-11V5l9-4z"/>
            </StackPane>
            <VBox spacing="2">
                <Label text="Biometric verification (face / empreinte digitale)" styleClass="nx-card-title"/>
                <Label text="Security policy for admin login and sensitive actions" styleClass="nx-card-subtitle"/>
            </VBox>
        </HBox>

        <VBox styleClass="nx-card-body" spacing="14">
            <CheckBox fx:id="chkRequireBiometricOnAdminLogin"
                      text="Require biometric verification (face / empreinte digitale) on admin login"
                      styleClass="nx-admin-check"/>

            <CheckBox fx:id="chkRequireBiometricOnSensitiveActions"
                      text="Require biometric verification (face / empreinte digitale) for sensitive actions"
                      styleClass="nx-admin-check"/>

            <CheckBox fx:id="chkEnableEmailOtp"
                      text="Enable email OTP verification"
                      styleClass="nx-admin-check"/>

            <Label text="A branded verification dialog appears first, then biometric verification is triggered."
                   styleClass="nx-admin-helper"/>
        </VBox>

        <HBox styleClass="nx-card-footer" alignment="CENTER_RIGHT" spacing="12">
            <Button text="Reload" styleClass="nx-btn, nx-btn-outline" onAction="#handleReloadSettings"/>
            <Button text="Enable face / empreinte digitale" styleClass="nx-btn, nx-btn-outline" onAction="#handleOpenBiometricSettings"/>
            <Button text="Test biometric verification" styleClass="nx-btn, nx-btn-secondary" onAction="#handleTestBiometricVerification"/>
            <Button text="Save" styleClass="nx-btn, nx-btn-primary" onAction="#handleSaveSettings"/>
        </HBox>
    </VBox>

    <HBox spacing="8" alignment="CENTER_LEFT">
        <Label text="Status:" styleClass="nx-table-subtitle"/>
        <Label fx:id="lblStatus" text="Loading..." styleClass="nx-admin-status"/>
        <Region HBox.hgrow="ALWAYS"/>
        <padding>
            <Insets top="8" right="0" bottom="0" left="0"/>
        </padding>
    </HBox>

    <padding>
        <Insets top="0" right="0" bottom="0" left="0"/>
    </padding>
</VBox>
